#!/bin/sh -eu

COMMAND="$(dmenu < /dev/null)"
[ -z "$COMMAND" ] && exit 0

EXE="${COMMAND%% *}"
command -v "$EXE" 1>/dev/null 2>&1 || {
	notify-send "[ERROR]: executable \"$EXE\" not found"
	exit 1
}

OUTPUT="$(eval "$COMMAND" 2>&1)" || {
	notify-send "$(printf '[ERROR]: command "%s" exited with exit code "%i", output:\n%s' "$COMMAND" "$?" "$OUTPUT")"
	exit 1
}

[ "$#" -eq 1 ] && [ "$1" = '-s' ] && exit 0
	
exec notify-send "$OUTPUT"
