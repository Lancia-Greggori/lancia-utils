#!/bin/bash -eu

[ "$#" -eq 0 ] && exit 1

. /usr/local/subr/download.subr

CURL_OUTPUT=''

extract_class()
{
	grep -m"$1" -Eo "class=\"$2\"[^<]+" | sed -e 's/class=[^>]\+>//' -e '/^[ ,]*$/d' | tr '\n' ','
}

for word in "$@"; do

	word="${word/./}"

	CURL_OUTPUT="$(curl_command "https://dictionary.cambridge.org/dictionary/spanish-english/${word}")"
	[ -z "$CURL_OUTPUT" ] && echo "- $word: [ERROR]" && continue
	echo "- $word"

	printf '%s meaning: %s\n' '--' "$(echo "$CURL_OUTPUT" | extract_class 3 'trans dtrans')"

done
